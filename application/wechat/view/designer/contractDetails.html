<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <title>项目明细</title>
    {include file="base_mui/weui_wechat"/}
</head>
<!--<style type="text/css">-->
    <!--.detalisleft {-->
        <!--width: 10%;-->
    <!--}-->

    <!--.detalisright {-->
        <!--width: 40%;-->
    <!--}-->

    <!--.detalboth {-->
        <!--width: 50%;-->
    <!--}-->

    <!--.detail_line {-->
        <!--border-bottom: 1px solid silver;-->
    <!--}-->

    <!--.addcc {-->
        <!--font-size: 15px;-->
        <!--padding: 0.2rem 0.2rem;-->
        <!--width: 90%;-->
        <!--padding-bottom: 10%;-->
        <!--background: white;-->
        <!--border: 1px silver solid;-->
        <!--border-radius: 10px;-->
        <!--display: none;-->
        <!--position: fixed;-->
        <!--left: 5%;-->
        <!--top: 20%-->

    <!--}-->

    <!--.addLog {-->
        <!--background: firebrick;-->
        <!--font-size: 15px;-->
        <!--padding: 0.2rem 0.2rem;-->
        <!--width: 90%;-->
        <!--padding-bottom: 10%;-->
        <!--background: white;-->
        <!--border: 1px silver solid;-->
        <!--border-radius: 10px;-->
        <!--display: none;-->
        <!--position: fixed;-->
        <!--left: 5%;-->
        <!--top: 20%-->

    <!--}-->

    <!--.addColl {-->
        <!--background: firebrick;-->
        <!--font-size: 13px;-->
        <!--padding: 0.2rem 0.2rem;-->
        <!--width: 90%;-->
        <!--padding-bottom: 10%;-->
        <!--background: white;-->
        <!--border: 1px silver solid;-->
        <!--border-radius: 10px;-->
        <!--display: none;-->
        <!--position: fixed;-->
        <!--left: 5%;-->
        <!--top: 20%-->
    <!--}-->

    <!--.addPro {-->
        <!--text-align: center;-->
        <!--height: 0.5rem;-->
        <!--width: 100%;-->
        <!--font-size: 16px;-->

    <!--}-->

    <!--.addBoss {-->
        <!--margin-top: 50px;-->
        <!--font-size: 13px;-->
        <!--padding-left: 0.2rem;-->
        <!--padding-right: 0.2rem;-->
    <!--}-->

    <!--.addFirst {-->

        <!--border-top: 1px solid silver;-->
        <!--border-left: 1px solid silver;-->
        <!--border-right: 1px solid silver;-->
        <!--border-bottom: 1px solid silver;-->
        <!--border-radius: 0.1rem;-->
        <!--margin-bottom: 0.3rem;-->

    <!--}-->


<!--</style>-->
<body>
<div id="details">
    <header class="mui-bar mui-bar-nav ">
        <a class=" mui-icon mui-icon-left-nav mui-pull-left  mui-action-back" ></a>
        <h1 class="mui-title">项目明细</h1>
        <a id="menu" class=" mui-icon mui-icon mui-icon-checkmarkempty mui-pull-right" href="#topPopover"
           @click="contract"></a>
        <!--<a class="mui-icon mui-icon mui-icon-plusempty mui-pull-right mui-btn-primary mui-btn-block" id="openPopover" style="font-size: 24px;"></a>-->
    </header>


    <div class="addBoss">
        <div class="addFirst">
            <div class="addPro">项目详情</div>
            <div class="detailBoss detail_line">

                <div style="display: inline-block;width: 20%;float: left;">项目名称：</div>
                <div style="display: inline-block;width: 72%;">
                    {$project.project_name}
                </div>
            </div>
            <div class="detailBoss detail_line">

                <div style="display: inline-block;width: 20%;float: left;">客户来源：</div>
                <div style="display: inline-block;width: 73%;">
                    {$value.customer_source[$project.customer_source] ?? "--"}
                </div>
            </div>
            <div class="detail_line">
                <div style="width: 49%;display: inline-block;padding-top: 0.1rem;padding-bottom: 0.1rem">
                    <span>装修类型：</span> <span>{$value.decoration_type[$project.decoration_type] ?? "--"}</span>
                </div>
                <div style="width: 49%;display: inline-block;padding-top: 0.1rem;padding-bottom: 0.1rem">
                    <span>装修档次：</span> <span>{$value.decoration_grade[$project.decoration_grade] ?? "--"}</span>
                </div>
            </div>
            <div class="detail_line">
                <div style="width: 49%;display: inline-block;padding-top: 0.1rem;padding-bottom: 0.1rem">
                    <span>色彩取向：</span> <span>{$value.color_orientation[$project.color_orientation] ?? "--"}</span>
                </div>
                <div style="width: 49%;display: inline-block;padding-top: 0.1rem;padding-bottom: 0.1rem">
                    <span>装修风格：</span> <span>{$value.decoration_style[$project.decoration_style] ?? "--"}</span>
                </div>
            </div>
            <div class="detail_line">
                <div style="width: 49%;display: inline-block;padding-top: 0.1rem;padding-bottom: 0.1rem;text-overflow:ellipsis">
                    <span>装修面积：</span> <span>{$project.decoration_area ?? "--"}</span>
                </div>
                <div style="width: 49%;display: inline-block;padding-top: 0.1rem;padding-bottom: 0.1rem">
                    <span>预算总工期：</span> <span>{$project.expected_duration ?? "--"}</span>
                </div>
            </div>
            <div class="detail_line">
                <div style="width: 49%;display: inline-block;padding-top: 0.1rem;padding-bottom: 0.1rem" >
                    <span>工程地址：</span> <span>{$project.project_address ?? "--"}</span>
                </div>
                <div style="width: 49%;display: inline-block;padding-top: 0.1rem;padding-bottom: 0.1rem">
                    <span>工程预算：</span> <span>{$project.project_budget ?? "--"}</span>
                </div>
            </div>
            <div class="detailBoss ">

                <div class="detailLeftOnly">项目要求：</div>
                <div class="detailRightOnly">
                    {$project.project_description ?? "--"}
                </div>
            </div>
        </div>
        <div class="addColl">
            <div style="text-align: center;">申请合同签订</div>
            <form method="post" name="form" id="form_add">

                <div style="width: 100%;padding-top: 0.1rem;padding-bottom: 0.1rem">

                    <div style="width: 100%;padding-top: 0.1rem;padding-bottom: 0.1rem">
                        <div style="display:inline-block; width: 25%;text-align: left;float: left">说明：</div>
                        <textarea style="width: 75%;display:inline-block;background: lavender;height: 2rem"
                                  id="remind_content" name="transfer_desc"></textarea>
                    </div>

                    <div style="margin-top: 0.3rem;text-align: center">
                        <button @click="shenqing()" type="button">申请</button>
                        <button style="margin-left: 0.3rem" @click="close" type="button">关闭</button>
                    </div>
                </div>
            </form>
        </div>

    </div>

</div>

</div>
</body>
</html>
<script type="text/javascript">
    window.onload = function () {
        var number;
        mui.ajax('{:url("erp/design_extract/shownocontract")}', {

            dataType: 'json',//服务器返回json格式数据
            type: 'post',//HTTP请求类型
//            timeout: 10000,//超时时间设置为10秒；
            success: function (response) {
                console.log(response)
            }
        })

        var dataA = {};
        mui.ajax('/erp/project/showContacts/project_guid/' + "{$project.guid}", {

            dataType: 'json',//服务器返回json格式数据
            type: 'post',//HTTP请求类型
//            timeout: 10000,//超时时间设置为10秒；
            success: function (response) {
                console.log("{$project.guid}")

                var vue = new Vue({
                    el: '#details',
                    data: dataA,
                    methods: {
                        contract: function (id) {

                            $(".addColl").css("display", "block")
                        },
                        close: function () {
                            $(".addColl").css("display", "none")
                        },
                        shenqing: function () {
                            var content = $("#form_add").serialize();
                            console.log(content)
                            mui.ajax('{:url("erp/design_extract/addprojectauditedit",["guid"=>$project_guid,"number"=>$number])}', {
                                data: content,
                                dataType: 'json',//服务器返回json格式数据
                                type: 'post',//HTTP请求类型
                                success: function (response) {
                                    if (response.code == 1001) {
                                        mui.toast(response.msg, {duration: 'short', type: 'div'});
                                        $(".addColl").css("display", "none")
                                    }
                                    else {
                                        mui.toast(response.msg, {duration: 'short', type: 'div'});
                                    }

                                },
                                error: function () {
                                    mui.toast("请求失败", {duration: 'short', type: 'div'});
                                }
                            })
                        },
//                        detailsBack: function () {
//
//                            mui.openWindow({
//                                url: "{:url('designer/contract')}"
//                            })
//                        }
//
                    }
                })
            }
        })
    }
</script>